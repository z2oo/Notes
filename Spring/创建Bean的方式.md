## 创建Bean的3种方式
在大多数情况下，Spring 容器会直接通过 new 关键字调用构造器来创建 Bean 实例，而 class 属性指定了 Bean 实例的实现类。因此，<bean> 元素必须指定 Bean 实例的class 属性，但这并不是实例化 Bean 的唯一方式  

> 使用实例工厂方法创建 Bean 实例，以及使用子 Bean 方法创建 Bean 实例时，都可以不指定 class 属性

Spring 支持使用如下方式来创建 Bean
- 调用构造器创建 Bean
- 调用静态工厂方法创建 Bean
- 调用实例工厂方法创建 Bean

### 使用构造器创建 Bean 实例
使用构造器来创建 Bean 实例时最常见的情况，如果不采用构造注入，Spring 底层会调用 Bean 类的无参数构造器来创建实例，因此要求该 Bean 类提供无参数的构造器  

在这种情况下，class 元素时必须的(除非采用继承)，class 属性的值就是 Bean 实例的实现类

如果不采用构造注入，Spring 容器将使用默认的构造器来创建 Bean 实例，Spring 对 Bean 实例的所有属性执行**默认初始化**，即所有基本类型的值初始化为 **0** 或 **false**；所有引用类型的值初始化为 **null**  

接下来，BeanFactory 会根据**配置文件决定依赖关系**，先实例化被依赖的 Bean 实例，然后为 Bean 注入依赖关系，最后将一个完整的 Bean 实例返回给程序  

如果采用构造注入，则要求配置文件为 <bean>元素添加<constructor-arg> 子元素，每个 <constructor-arg> 子元素配置一个构造器参数  


### 使用静态工厂方法创建Bean
使用静态工厂方法创建 Bean 实例时，class 属性也必须指定，但此时 **class 属性并不是指定 Bean 实例的实现类，而是静态工厂类**，Spring 通过该属性知道由哪个工厂类来创建 Bean 实例  

除此之外，还需要使用 factory-method 属性来指定静态工厂方法，Spring 将调用静态工厂方法(可能包含一组参数)返回一个 Bean 实例，一旦获得了指定 Bean 实例，Spring 后面的处理步骤与采用普通方法创建 Bean 实例完全一样  

一旦为 <bean> 元素指定了 factory-method 属性，Spring 就不再调用构造器来创建 Bean 实例，而是调用工厂方法来创建 Bean 实例。  

如果同时指定了 class 和 factory-method 属性，Spring 就会调用静态工厂方法来创建 Bean  

使用静态工厂方法创建实例时必须提供工厂类，工厂类包含产生实例的静态工厂方法。通过静态工厂方法创建实例时需要对配置文件进行如下改变：
- class 属性的值不再是 Bean 实例的实现类，而是生成 Bean 实例的静态工厂类  
- 使用 factory-method 属性指定创建 Bean 实例的静态工厂方法
- 如果静态工厂方法需要参数，则使用 <constructor-arg>元素指定静态工厂方法的参数  

> 提示  
指定 Spring 使用静态工厂方法来创建 Bean 实例时，Spring 将先解析配置文件，并根据配置文件指定的信息，通过反射调用静态工厂的静态工厂方法，将该静态工厂方法的返回值作为 Bean 实例。  
在这个过程中，Spring 不再负责创建 Bean 实例，Bean 实例是由用户提供的静态工厂类负责创建的  

当静态工厂方法创建了 Bean 实例后，Spring 依然可以管理该 Bean 实例的依赖关系，包括为其注入所需的依赖 Bean、管理其生命周期等  


### 调用实例工厂方法创建Bean
实例工厂方法 与 静态工厂方法 只有一点不同：调用静态工厂方法只需使用工厂类即可，而调用实例工厂方法则需要工厂实例。所以，配置实例工厂方法与配置静态工厂方法基本相似，只有一点区别：
> 配置静态工厂方法使用 class 指定静态工厂，而配置实例工厂方法则使用 factory-bean 指定工厂实例

使用实例工厂方法时，配置 Bean 实例的 <bean> 元素无须 class 属性，因为 Spring 容器不再直接实例化该 Bean ，Spring 容器仅仅调用实例工厂的工厂方法，工厂方法负责创建 Bean 实例

采用实例工厂方法创建 Bean 的 <bean> 元素时需要指定如下两个属性：
- factory-bean：该属性的值为工厂 Bean 的id
- factory-method：指定实例工厂的工厂方法

---

调用实例工厂方法创建 Bean，与调用静态工厂方法创建 Bean 的用法基本相似。  
**区别**如下：
- 配置实例工厂方法创建 Bean，必须将实例工厂配置成 Bean 实例；而配置静态工厂方法创建 Bean，则无需配置工厂 Bean  
- 配置实例工厂方法创建 Bean，必须使用 factory-bean 属性确定工厂 Bean；而配置静态工厂方法创建 Bean，则使用 class 元素确定静态工厂类  

**相同**之处如下：
- 都需要使用 factory-method 属性指定产生 Bean 实例的工厂方法
- 工厂方法如果需要参数，都使用 <constructor-arg> 元素指定参数值
- 普通的设值注入，都使用 <property> 元素确定参数值


